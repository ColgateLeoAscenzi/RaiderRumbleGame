var RESET=!1,ATTACK=!0,anh={name:"Anh",model:createAnhMesh(0,0,0),hitBox:createBasicCharacterBounding(0,0,0),canAAttack:[!0,!0,!0,!0,!0],canBAttack:[!0,!0,!0,!0],hitByA:[!1,!1,!1,!1,!1],hitByB:[!1,!1,!1,!1],init:function(){for(var t=Object.keys(charProto),i=0;i<t.length;i++)this[t[i]]=charProto[t[i]];this.name="Anh",this.zs=createZ(stage,stage.maximumX+300,stage.maximumY+300,0),this.music=createMusic(stage,stage.maximumX+300,stage.maximumY+300,0),this.heldKeys={up:!1,down:!1,left:!1,right:!1,attack1:!1,attack2:!1},this.basicAttackObj=anhBasic,this.specialAttackObj=anhSpecial,this.damageDeal=0,this.maxJumpCt=4},resetAll:function(){},setSpawn:function(){this.isPlayer1?(this.x=stage.player1SpawnX,this.y=stage.player1SpawnY,this.z=stage.player1SpawnZ):(this.x=stage.player2SpawnX,this.y=stage.player2SpawnY,this.z=stage.player2SpawnZ)},update:function(){if(this.onGround||(this.isPlayer1?player1Info.inAirDuration+=1/60:player2Info.inAirDuration+=1/60),isDay||(this.isPlayer1?(stage.player1SpotTarget.position.set(this.x,this.y+10,-10),stage.player1Spot.target=stage.player1SpotTarget):(stage.player2SpotTarget.position.set(this.x,this.y+10,-10),stage.player2Spot.target=stage.player2SpotTarget)),this.hitbbox=(new THREE.Box3).setFromObject(this.hitBox),null!=this.boxBelow?this.minDown=this.boxBelow.position.y+this.boxBelow.userData.height/2+this.height/2:this.minDown=-1e3,null!=this.boxLeft?this.minLeft=this.boxLeft.position.x+this.boxLeft.userData.width/2+this.width/2:this.minLeft=-1e3,null!=this.boxRight?this.minRight=this.boxRight.position.x-this.boxRight.userData.width/2-this.width/2:this.minRight=1e3,null!=this.boxAbove?this.minUp=this.boxAbove.position.y-this.boxAbove.userData.height/2-this.height/2:this.minUp=1e5,this.isHit&&(this.hitFrames-=1,this.sleeping&&(this.sleeping=!1,this.basicAttackFrames=0)),this.hitFrames<0&&(this.isHit=!1),this.yVel-.075<-1.6&&(this.yVel=-1.6),this.yVel-=.075,this.x+=this.xVel,this.y+=this.yVel,this.xVel>8||this.yVel>8){var t=this.model.clone();stage.scene.add(t),setTimeout(function(){stage.scene.remove(t)},50)}this.heldKeys.up&&this.heldKeys.attack2&&this.canRecover&&!this.isRecover&&(this.sleeping||(this.recover(),this.canJump=!1)),!this.heldKeys.right||this.heldKeys.left||this.isHit||this.heldKeys.attack1||this.heldKeys.attack2||this.sleeping||this.isHit||this.walkRight(),!this.heldKeys.left||this.heldKeys.right||this.isHit||this.heldKeys.attack1||this.heldKeys.attack2||this.sleeping||this.isHit||this.walkLeft(),this.movingR||this.movingL||!this.onGround||this.isHit||(this.xVel=.7*this.xVel),this.movingR||this.movingL||this.onGround||this.isHit||(this.xVel=.99*this.xVel),Math.abs(this.xVel)<5e-4&&(this.xVel=0),this.y<this.minDown&&(this.y=this.minDown,this.canJump=!0,this.jumpCt=0,this.onGround=!0,this.canRecover=!0,this.isRecover=!1),this.y>this.minUp&&(this.y=this.minUp,this.yVel=0),this.x<this.minLeft&&(this.x=this.minLeft),this.x>this.minRight&&(this.x=this.minRight),0==this.stock?(this.model.position.set(1e3,1e3,0),this.hitBox.position.set(1e3,1e3,0)):(this.model.position.set(this.x,this.y,0),this.hitBox.position.set(this.x,this.y+4,0)),this.y>this.minDown&&(this.onGround=!1)},animate:function(){if(this.facingR&&(this.model.rotation.y=.5),this.facingL&&(this.model.rotation.y=-.5),!this.movingR&&!this.movingL||0==this.xVel||this.isHit?(this.model.torso.rightLeg.position.y=-3,this.model.torso.leftLeg.position.y=-3,this.model.torso.rightLeg.rotation.x=0,this.model.torso.leftLeg.rotation.x=0,this.model.torso.rightArm.rotation.x=0,this.model.torso.leftArm.rotation.x=-0,this.canBasicAttack&&!this.sleeping&&(this.model.rotation.z=0)):(this.walkStyle1?(this.model.torso.rightLeg.position.y=.5*Math.sin(.5*stage.timer)-3,this.model.torso.leftLeg.position.y=-3-.5*Math.sin(.5*stage.timer)):this.walkStyle2?(this.model.torso.rightLeg.rotation.x=.3*Math.sin(.5*stage.timer),this.model.torso.leftLeg.rotation.x=-.3*Math.sin(.5*stage.timer)):this.walkStyle3&&(this.model.torso.rightLeg.position.y=.5*Math.sin(.2*stage.timer)-3,this.model.torso.leftLeg.position.y=-3-.5*Math.sin(.2*stage.timer),this.model.rotation.z=.1*Math.sin(.2*stage.timer)),this.model.torso.rightArm.rotation.x=.3*Math.sin(.5*stage.timer),this.model.torso.leftArm.rotation.x=-.3*Math.sin(.5*stage.timer),this.canBasicAttack&&!this.sleeping&&(this.model.rotation.z=0)),stage.timer%500==0?(this.model.head.rightEye.scale.set(1,.2,1),this.model.head.leftEye.scale.set(1,.2,1)):(this.model.head.rightEye.scale.set(1,1,1),this.model.head.leftEye.scale.set(1,1,1)),this.canAAttack[A]||(this.basicAttackFrames-=1,this.basicAttackFrames<=0&&(this.basicAttackFrames=25,this.canAAttack[A]=!0,this.canBasicAttack=!0,this.otherPlayer.hitByA[A]=!1)),this.canAAttack[FA]||(this.basicAttackFrames-=1,this.basicAttackFrames<=0&&(this.basicAttackFrames=25,this.canAAttack[FA]=!0,this.canBasicAttack=!0,this.otherPlayer.hitByA[FA]=!1)),this.canAAttack[BA]||(this.basicAttackFrames-=1,this.basicAttackFrames<=0&&(this.basicAttackFrames=25,this.canAAttack[BA]=!0,this.canBasicAttack=!0,this.otherPlayer.hitByA[BA]=!1)),this.canAAttack[DA]||(this.basicAttackFrames-=1,this.basicAttackFrames<=0&&(this.basicAttackFrames=25,this.canAAttack[DA]=!0,this.canBasicAttack=!0,this.otherPlayer.hitByA[DA]=!1)),this.canAAttack[UA]||(this.basicAttackFrames-=1,this.basicAttackFrames<=0&&(this.basicAttackFrames=25,this.canAAttack[UA]=!0,this.canBasicAttack=!0,this.otherPlayer.hitByA[UA]=!1)),this.canAAttack[NA]||(this.basicAttackFrames-=1,this.basicAttackFrames<=0&&(this.basicAttackFrames=25,this.canAAttack[NA]=!0,this.canBasicAttack=!0,this.otherPlayer.hitByA[NA]=!1)),this.canBAttack[S]||(this.basicAttackFrames-=1,this.basicAttackFrames<=0&&(this.basicAttackFrames=25,this.canBAttack[S]=!0,this.canBasicAttack=!0,this.otherPlayer.hitByB[S]=!1)),this.canBAttack[SS]||(this.basicAttackFrames-=1,this.basicAttackFrames<=0&&(this.basicAttackFrames=25,this.canBAttack[SS]=!0,this.canBasicAttack=!0,this.otherPlayer.hitByB[SS]=!1)),this.canBAttack[US]||(this.basicAttackFrames-=1,this.basicAttackFrames<=0&&(this.basicAttackFrames=25,this.canBAttack[US]=!0,this.canBasicAttack=!0,this.otherPlayer.hitByB[US]=!1)),!this.canBAttack[DS]){this.sleeping=!0,this.basicAttackFrames-=1;var t=(this.specialAttackObj.attackFrames[DS]-this.basicAttackFrames)/this.specialAttackObj.attackFrames[DS];this.zs.position.set(this.x-5,this.y+5,this.z),t<.25&&(this.model.rotation.z=4*t*1.57);this.basicAttackFrames>this.specialAttackObj.attackFrames[DS]-5&&this.x<=this.otherPlayer.x+6&&this.x>=this.otherPlayer.x-6&&this.y<=this.otherPlayer.y+6&&this.y>=this.otherPlayer.y-6&&this.z<=this.otherPlayer.z+6&&this.z>=this.otherPlayer.z-6&&(this.isPlayer1?player1Info.damageDealt+=130:player2Info.damageDealt+=130,this.otherPlayer.percentage+=130,this.checkHit(DS,"B")),this.model.head.leftEye.scale.y=.1,this.model.head.rightEye.scale.y=.1,this.basicAttackFrames<=0&&(this.model.rotation.z=0,this.model.head.leftEye.scale.y=1,this.model.head.rightEye.scale.y=1,this.sleeping=!1,this.zs.position.set(stage.maximumX+300,stage.maximumY+300,0),this.basicAttackFrames=25,this.canBAttack[DS]=!0,this.canBasicAttack=!0,this.otherPlayer.hitByB[DS]=!1)}},walkRight:function(){this.movingR=!0,this.facingR=!0,this.facingL=!1,this.xVel+=this.xAccel,this.xVel>this.maxXVel&&(this.xVel=this.maxXVel),this.isHit=!1},walkLeft:function(){this.movingL=!0,this.facingL=!0,this.facingR=!1,this.xVel-=this.xAccel,this.xVel<-this.maxXVel&&(this.xVel=-this.maxXVel),this.isHit=!1},jump:function(){this.sleeping||(this.jumpCt==this.maxJumpCt&&(this.canJump=!1),this.canJump&&(this.isHit||(this.jumpCt+=1,this.yVel=this.jumpSpeed,this.onGround=!1,this.isHit=!1)))},drop:function(){},recover:function(){this.isRecover=!0,this.yVel=this.recoverVel,this.canRecover=!1,this.isHit=!1},doAnyAttack:function(){var t=!1;if(this.canBasicAttack&&!this.isHit&&!this.isRecover){var i=0;this.heldKeys.up&&this.heldKeys.attack2&&this.canRecover&&!this.isRecover&&(this.recover(),this.canJump=!1),this.facingR&&this.heldKeys.right&&this.heldKeys.attack1&&!this.onGround&&this.canBasicAttack&&this.canAAttack[FA]&&(t=!0,i=this.basicAttackObj.attackFrames[FA],this.canAAttack[FA]=!1,this.canBasicAttack=!1),this.facingL&&this.heldKeys.left&&this.heldKeys.attack1&&!this.onGround&&this.canBasicAttack&&1==this.canAAttack[FA]&&(t=!0,i=this.basicAttackObj.attackFrames[FA],this.canAAttack[FA]=!1,this.canBasicAttack=!1),this.facingL&&this.heldKeys.right&&this.heldKeys.attack1&&!this.onGround&&this.canBasicAttack&&1==this.canAAttack[BA]&&(t=!0,i=this.basicAttackObj.attackFrames[BA],this.canAAttack[BA]=!1,this.canBasicAttack=!1),this.facingR&&this.heldKeys.left&&this.heldKeys.attack1&&!this.onGround&&this.canBasicAttack&&1==this.canAAttack[BA]&&(t=!0,i=this.basicAttackObj.attackFrames[BA],this.canAAttack[BA]=!1,this.canBasicAttack=!1),this.heldKeys.down&&this.heldKeys.attack1&&!this.onGround&&this.canBasicAttack&&1==this.canAAttack[DA]&&(t=!0,i=this.basicAttackObj.attackFrames[DA],this.canAAttack[DA]=!1,this.canBasicAttack=!1),this.heldKeys.up&&this.heldKeys.attack1&&!this.onGround&&this.canBasicAttack&&1==this.canAAttack[UA]&&(t=!0,i=this.basicAttackObj.attackFrames[UA],this.canAAttack[UA]=!1,this.canBasicAttack=!1),this.heldKeys.left||this.heldKeys.right||this.heldKeys.up||this.heldKeys.down||!this.heldKeys.attack1||this.onGround||!this.canBasicAttack||1==this.canAAttack[NA]&&(t=!0,i=this.basicAttackObj.attackFrames[NA],this.canAAttack[NA]=!1,this.canBasicAttack=!1),this.heldKeys.attack1&&this.onGround&&this.canBasicAttack&&1==this.canAAttack[A]&&(t=!0,i=this.basicAttackObj.attackFrames[A],this.canAAttack[A]=!1,this.canBasicAttack=!1),(this.heldKeys.right||this.heldKeys.left)&&this.heldKeys.attack2&&this.canBasicAttack&&1==this.canBAttack[SS]&&(t=!0,i=this.specialAttackObj.attackFrames[SS],this.canBAttack[SS]=!1,this.canBasicAttack=!1),this.heldKeys.down||this.heldKeys.up||this.heldKeys.left||this.heldKeys.right||!this.heldKeys.attack2||!this.canBasicAttack||1==this.canBAttack[S]&&(t=!0,i=this.specialAttackObj.attackFrames[S],this.canBAttack[S]=!1,this.canBasicAttack=!1),this.heldKeys.down&&this.heldKeys.attack2&&this.canBasicAttack&&1==this.canBAttack[DS]&&(t=!0,i=this.specialAttackObj.attackFrames[DS],this.canBAttack[DS]=!1,this.canBasicAttack=!1),this.heldKeys.up&&this.heldKeys.attack2&&this.canBasicAttack&&1==this.canBAttack[US]&&(t=!0,i=this.specialAttackObj.attackFrames[US],this.canBAttack[US]=!1,this.canBasicAttack=!1),this.basicAttackFrames=i,t&&(this.isPlayer1?player1Info.totalAttacksCast+=1:player2Info.totalAttacksCast+=1)}},checkHit:function(t,i){"A"==i?this.otherPlayer.hitByA[t]||(damageToDeal=this.basicAttackObj.damage[t],angleToApply=this.basicAttackObj.launchAngle[t],tKnockback=calculateKnockback(this.otherPlayer.percentage,this.basicAttackObj.damage[t],this.otherPlayer.weight,this.basicAttackObj.scaling,this.basicAttackObj.knockback),this.otherPlayer.isHit=!0,this.isPlayer1?player1Info.totalAttacksHit+=1:player2Info.totalAttacksHit+=1,this.otherPlayer.hitByA[t]=!0,this.doKnockBack(damageToDeal,angleToApply,tKnockback)):this.otherPlayer.hitByB[t]||(damageToDeal=this.specialAttackObj.damage[t],angleToApply=this.specialAttackObj.launchAngle[t],tKnockback=calculateKnockback(this.otherPlayer.percentage,this.specialAttackObj.damage[t],this.otherPlayer.weight,this.specialAttackObj.scaling,this.specialAttackObj.knockback),this.otherPlayer.isHit=!0,this.isPlayer1?player1Info.totalAttacksHit+=1:player2Info.totalAttacksHit+=1,this.otherPlayer.hitByB[t]=!0,this.doKnockBack(damageToDeal,angleToApply,tKnockback))},doKnockBack:function(t,i,s){var a,e,h=new THREE.Vector2;h.x=this.otherPlayer.x-this.x,h.y=this.otherPlayer.y-this.y,h=h.normalize(),a=Math.cos(radians(i))*h.x-Math.sin(radians(i))*h.y,e=Math.sin(radians(i))*h.x+Math.cos(radians(i))*h.y,h.x=a,h.y=Math.abs(e),h=h.normalize(),this.isPlayer1?player1Info.damageDealt+=t:player2Info.damageDealt+=t,this.otherPlayer.percentage+=t,this.otherPlayer.xVel=.5*s*h.x,this.otherPlayer.yVel=.5*s*h.y,this.otherPlayer.hitFrames=2*t,this.otherPlayer.xVel>0?this.otherPlayer.model.rotation.z=-1.57:this.otherPlayer.model.rotation.z=1.57}};function createZ(t,i,s,a){var e=new THREE.Mesh,h=new THREE.Mesh,c=particles.particlePalette.sleepPiece.clone();h.add(c),c.position.x+=2;var o=particles.particlePalette.sleepPiece.clone();h.add(o);var n=particles.particlePalette.sleepPiece.clone();h.add(n),n.position.x-=2;var l=particles.particlePalette.sleepPiece.clone();h.add(l),l.position.x-=1.2,l.position.y+=2;var r=particles.particlePalette.sleepPiece.clone();h.add(r),r.position.x+=1.2,r.position.y+=4;var A=particles.particlePalette.sleepPiece.clone();h.add(A),A.position.x+=2,A.position.y+=6;var k=particles.particlePalette.sleepPiece.clone();h.add(k),k.position.y+=6;var y=particles.particlePalette.sleepPiece.clone();return h.add(y),y.position.x-=2,y.position.y+=6,z2=h.clone(),z3=h.clone(),h.scale.set(.3,.3,.3),e.add(h),z2.scale.set(.45,.45,.45),e.add(z2),z2.position.set(-1.4,2.5,0),z3.scale.set(.55,.55,.55),e.add(z3),z3.position.set(1.8,7.2,0),t.scene.add(e),e.position.set(i,s,a),e}function createMusic(t,i,s,a){for(var e=[],h=0;h<27;h++){var c=particles.particlePalette.musicPiece.clone();e.push(c),t.scene.add(c)}return e}var anh1={name:"Anh",model:createAnhMesh(0,0,0),hitBox:createBasicCharacterBounding(0,0,0),canAAttack:[!0,!0,!0,!0,!0],canBAttack:[!0,!0,!0,!0],hitByA:[!1,!1,!1,!1,!1],hitByB:[!1,!1,!1,!1],init:function(){for(var t=Object.keys(charProto),i=0;i<t.length;i++)this[t[i]]=charProto[t[i]];this.name="Anh",this.zs=createZ(stage,stage.maximumX+300,stage.maximumY+300,0),this.music=createMusic(stage,stage.maximumX+300,stage.maximumY+300,0),this.heldKeys={up:!1,down:!1,left:!1,right:!1,attack1:!1,attack2:!1},this.basicAttackObj=anhBasic,this.specialAttackObj=anhSpecial,this.damageDeal=0,this.maxJumpCt=4},resetAll:function(){},setSpawn:function(){this.isPlayer1?(this.x=stage.player1SpawnX,this.y=stage.player1SpawnY,this.z=stage.player1SpawnZ):(this.x=stage.player2SpawnX,this.y=stage.player2SpawnY,this.z=stage.player2SpawnZ)},update:function(){if(this.onGround||(this.isPlayer1?player1Info.inAirDuration+=1/60:player2Info.inAirDuration+=1/60),isDay||(this.isPlayer1?(stage.player1SpotTarget.position.set(this.x,this.y+10,-10),stage.player1Spot.target=stage.player1SpotTarget):(stage.player2SpotTarget.position.set(this.x,this.y+10,-10),stage.player2Spot.target=stage.player2SpotTarget)),this.hitbbox=(new THREE.Box3).setFromObject(this.hitBox),null!=this.boxBelow?this.minDown=this.boxBelow.position.y+this.boxBelow.userData.height/2+this.height/2:this.minDown=-1e3,null!=this.boxLeft?this.minLeft=this.boxLeft.position.x+this.boxLeft.userData.width/2+this.width/2:this.minLeft=-1e3,null!=this.boxRight?this.minRight=this.boxRight.position.x-this.boxRight.userData.width/2-this.width/2:this.minRight=1e3,null!=this.boxAbove?this.minUp=this.boxAbove.position.y-this.boxAbove.userData.height/2-this.height/2:this.minUp=1e5,this.isHit&&(this.hitFrames-=1,this.sleeping&&(this.sleeping=!1,this.basicAttackFrames=0)),this.hitFrames<0&&(this.isHit=!1),this.yVel-.075<-1.6&&(this.yVel=-1.6),this.yVel-=.075,this.x+=this.xVel,this.y+=this.yVel,this.xVel>8||this.yVel>8){var t=this.model.clone();stage.scene.add(t),setTimeout(function(){stage.scene.remove(t)},50)}this.heldKeys.up&&this.heldKeys.attack2&&this.canRecover&&!this.isRecover&&(this.sleeping||(this.recover(),this.canJump=!1)),!this.heldKeys.right||this.heldKeys.left||this.isHit||this.heldKeys.attack1||this.heldKeys.attack2||this.sleeping||this.isHit||this.walkRight(),!this.heldKeys.left||this.heldKeys.right||this.isHit||this.heldKeys.attack1||this.heldKeys.attack2||this.sleeping||this.isHit||this.walkLeft(),this.movingR||this.movingL||!this.onGround||this.isHit||(this.xVel=.7*this.xVel),this.movingR||this.movingL||this.onGround||this.isHit||(this.xVel=.99*this.xVel),Math.abs(this.xVel)<5e-4&&(this.xVel=0),this.y<this.minDown&&(this.y=this.minDown,this.canJump=!0,this.jumpCt=0,this.onGround=!0,this.canRecover=!0,this.isRecover=!1),this.y>this.minUp&&(this.y=this.minUp,this.yVel=0),this.x<this.minLeft&&(this.x=this.minLeft),this.x>this.minRight&&(this.x=this.minRight),0==this.stock?(this.model.position.set(1e3,1e3,0),this.hitBox.position.set(1e3,1e3,0)):(this.model.position.set(this.x,this.y,0),this.hitBox.position.set(this.x,this.y+4,0)),this.y>this.minDown&&(this.onGround=!1)},animate:function(){if(this.facingR&&(this.model.rotation.y=.5),this.facingL&&(this.model.rotation.y=-.5),!this.movingR&&!this.movingL||0==this.xVel||this.isHit?(this.model.torso.rightLeg.position.y=-3,this.model.torso.leftLeg.position.y=-3,this.model.torso.rightLeg.rotation.x=0,this.model.torso.leftLeg.rotation.x=0,this.model.torso.rightArm.rotation.x=0,this.model.torso.leftArm.rotation.x=-0,this.canBasicAttack&&!this.sleeping&&(this.model.rotation.z=0)):(this.walkStyle1?(this.model.torso.rightLeg.position.y=.5*Math.sin(.5*stage.timer)-3,this.model.torso.leftLeg.position.y=-3-.5*Math.sin(.5*stage.timer)):this.walkStyle2?(this.model.torso.rightLeg.rotation.x=.3*Math.sin(.5*stage.timer),this.model.torso.leftLeg.rotation.x=-.3*Math.sin(.5*stage.timer)):this.walkStyle3&&(this.model.torso.rightLeg.position.y=.5*Math.sin(.2*stage.timer)-3,this.model.torso.leftLeg.position.y=-3-.5*Math.sin(.2*stage.timer),this.model.rotation.z=.1*Math.sin(.2*stage.timer)),this.model.torso.rightArm.rotation.x=.3*Math.sin(.5*stage.timer),this.model.torso.leftArm.rotation.x=-.3*Math.sin(.5*stage.timer),this.canBasicAttack&&!this.sleeping&&(this.model.rotation.z=0)),stage.timer%500==0?(this.model.head.rightEye.scale.set(1,.2,1),this.model.head.leftEye.scale.set(1,.2,1)):(this.model.head.rightEye.scale.set(1,1,1),this.model.head.leftEye.scale.set(1,1,1)),this.canAAttack[A]||(this.basicAttackFrames-=1,this.basicAttackFrames<=0&&(this.basicAttackFrames=25,this.canAAttack[A]=!0,this.canBasicAttack=!0,this.otherPlayer.hitByA[A]=!1)),this.canAAttack[FA]||(this.basicAttackFrames-=1,this.basicAttackFrames<=0&&(this.basicAttackFrames=25,this.canAAttack[FA]=!0,this.canBasicAttack=!0,this.otherPlayer.hitByA[FA]=!1)),this.canAAttack[BA]||(this.basicAttackFrames-=1,this.basicAttackFrames<=0&&(this.basicAttackFrames=25,this.canAAttack[BA]=!0,this.canBasicAttack=!0,this.otherPlayer.hitByA[BA]=!1)),this.canAAttack[DA]||(this.basicAttackFrames-=1,this.basicAttackFrames<=0&&(this.basicAttackFrames=25,this.canAAttack[DA]=!0,this.canBasicAttack=!0,this.otherPlayer.hitByA[DA]=!1)),this.canAAttack[UA]||(this.basicAttackFrames-=1,this.basicAttackFrames<=0&&(this.basicAttackFrames=25,this.canAAttack[UA]=!0,this.canBasicAttack=!0,this.otherPlayer.hitByA[UA]=!1)),this.canAAttack[NA]||(this.basicAttackFrames-=1,this.basicAttackFrames<=0&&(this.basicAttackFrames=25,this.canAAttack[NA]=!0,this.canBasicAttack=!0,this.otherPlayer.hitByA[NA]=!1)),this.canBAttack[S]||(this.basicAttackFrames-=1,this.basicAttackFrames<=0&&(this.basicAttackFrames=25,this.canBAttack[S]=!0,this.canBasicAttack=!0,this.otherPlayer.hitByB[S]=!1)),this.canBAttack[SS]||(this.basicAttackFrames-=1,this.basicAttackFrames<=0&&(this.basicAttackFrames=25,this.canBAttack[SS]=!0,this.canBasicAttack=!0,this.otherPlayer.hitByB[SS]=!1)),this.canBAttack[US]||(this.basicAttackFrames-=1,this.basicAttackFrames<=0&&(this.basicAttackFrames=25,this.canBAttack[US]=!0,this.canBasicAttack=!0,this.otherPlayer.hitByB[US]=!1)),!this.canBAttack[DS]){this.sleeping=!0,this.basicAttackFrames-=1;var t=(this.specialAttackObj.attackFrames[DS]-this.basicAttackFrames)/this.specialAttackObj.attackFrames[DS];this.zs.position.set(this.x-5,this.y+5,this.z),t<.25&&(this.model.rotation.z=4*t*1.57);this.basicAttackFrames>this.specialAttackObj.attackFrames[DS]-5&&this.x<=this.otherPlayer.x+6&&this.x>=this.otherPlayer.x-6&&this.y<=this.otherPlayer.y+6&&this.y>=this.otherPlayer.y-6&&this.z<=this.otherPlayer.z+6&&this.z>=this.otherPlayer.z-6&&(this.isPlayer1?player1Info.damageDealt+=130:player2Info.damageDealt+=130,this.otherPlayer.percentage+=130,this.checkHit(DS,"B")),this.model.head.leftEye.scale.y=.1,this.model.head.rightEye.scale.y=.1,this.basicAttackFrames<=0&&(this.model.rotation.z=0,this.model.head.leftEye.scale.y=1,this.model.head.rightEye.scale.y=1,this.sleeping=!1,this.zs.position.set(stage.maximumX+300,stage.maximumY+300,0),this.basicAttackFrames=25,this.canBAttack[DS]=!0,this.canBasicAttack=!0,this.otherPlayer.hitByB[DS]=!1)}},walkRight:function(){this.movingR=!0,this.facingR=!0,this.facingL=!1,this.xVel+=this.xAccel,this.xVel>this.maxXVel&&(this.xVel=this.maxXVel),this.isHit=!1},walkLeft:function(){this.movingL=!0,this.facingL=!0,this.facingR=!1,this.xVel-=this.xAccel,this.xVel<-this.maxXVel&&(this.xVel=-this.maxXVel),this.isHit=!1},jump:function(){this.sleeping||(this.jumpCt==this.maxJumpCt&&(this.canJump=!1),this.canJump&&(this.isHit||(this.jumpCt+=1,this.yVel=this.jumpSpeed,this.onGround=!1,this.isHit=!1)))},drop:function(){},recover:function(){this.isRecover=!0,this.yVel=this.recoverVel,this.canRecover=!1,this.isHit=!1},doAnyAttack:function(){var t=!1;if(this.canBasicAttack&&!this.isHit&&!this.isRecover){var i=0;this.heldKeys.up&&this.heldKeys.attack2&&this.canRecover&&!this.isRecover&&(this.recover(),this.canJump=!1),this.facingR&&this.heldKeys.right&&this.heldKeys.attack1&&!this.onGround&&this.canBasicAttack&&this.canAAttack[FA]&&(t=!0,i=this.basicAttackObj.attackFrames[FA],this.canAAttack[FA]=!1,this.canBasicAttack=!1),this.facingL&&this.heldKeys.left&&this.heldKeys.attack1&&!this.onGround&&this.canBasicAttack&&1==this.canAAttack[FA]&&(t=!0,i=this.basicAttackObj.attackFrames[FA],this.canAAttack[FA]=!1,this.canBasicAttack=!1),this.facingL&&this.heldKeys.right&&this.heldKeys.attack1&&!this.onGround&&this.canBasicAttack&&1==this.canAAttack[BA]&&(t=!0,i=this.basicAttackObj.attackFrames[BA],this.canAAttack[BA]=!1,this.canBasicAttack=!1),this.facingR&&this.heldKeys.left&&this.heldKeys.attack1&&!this.onGround&&this.canBasicAttack&&1==this.canAAttack[BA]&&(t=!0,i=this.basicAttackObj.attackFrames[BA],this.canAAttack[BA]=!1,this.canBasicAttack=!1),this.heldKeys.down&&this.heldKeys.attack1&&!this.onGround&&this.canBasicAttack&&1==this.canAAttack[DA]&&(t=!0,i=this.basicAttackObj.attackFrames[DA],this.canAAttack[DA]=!1,this.canBasicAttack=!1),this.heldKeys.up&&this.heldKeys.attack1&&!this.onGround&&this.canBasicAttack&&1==this.canAAttack[UA]&&(t=!0,i=this.basicAttackObj.attackFrames[UA],this.canAAttack[UA]=!1,this.canBasicAttack=!1),this.heldKeys.left||this.heldKeys.right||this.heldKeys.up||this.heldKeys.down||!this.heldKeys.attack1||this.onGround||!this.canBasicAttack||1==this.canAAttack[NA]&&(t=!0,i=this.basicAttackObj.attackFrames[NA],this.canAAttack[NA]=!1,this.canBasicAttack=!1),this.heldKeys.attack1&&this.onGround&&this.canBasicAttack&&1==this.canAAttack[A]&&(t=!0,i=this.basicAttackObj.attackFrames[A],this.canAAttack[A]=!1,this.canBasicAttack=!1),(this.heldKeys.right||this.heldKeys.left)&&this.heldKeys.attack2&&this.canBasicAttack&&1==this.canBAttack[SS]&&(t=!0,i=this.specialAttackObj.attackFrames[SS],this.canBAttack[SS]=!1,this.canBasicAttack=!1),this.heldKeys.down||this.heldKeys.up||this.heldKeys.left||this.heldKeys.right||!this.heldKeys.attack2||!this.canBasicAttack||1==this.canBAttack[S]&&(t=!0,i=this.specialAttackObj.attackFrames[S],this.canBAttack[S]=!1,this.canBasicAttack=!1),this.heldKeys.down&&this.heldKeys.attack2&&this.canBasicAttack&&1==this.canBAttack[DS]&&(t=!0,i=this.specialAttackObj.attackFrames[DS],this.canBAttack[DS]=!1,this.canBasicAttack=!1),this.heldKeys.up&&this.heldKeys.attack2&&this.canBasicAttack&&1==this.canBAttack[US]&&(t=!0,i=this.specialAttackObj.attackFrames[US],this.canBAttack[US]=!1,this.canBasicAttack=!1),this.basicAttackFrames=i,t&&(this.isPlayer1?player1Info.totalAttacksCast+=1:player2Info.totalAttacksCast+=1)}},checkHit:function(t,i){"A"==i?this.otherPlayer.hitByA[t]||(damageToDeal=this.basicAttackObj.damage[t],angleToApply=this.basicAttackObj.launchAngle[t],tKnockback=calculateKnockback(this.otherPlayer.percentage,this.basicAttackObj.damage[t],this.otherPlayer.weight,this.basicAttackObj.scaling,this.basicAttackObj.knockback),this.otherPlayer.isHit=!0,this.isPlayer1?player1Info.totalAttacksHit+=1:player2Info.totalAttacksHit+=1,this.otherPlayer.hitByA[t]=!0,this.doKnockBack(damageToDeal,angleToApply,tKnockback)):this.otherPlayer.hitByB[t]||(damageToDeal=this.specialAttackObj.damage[t],angleToApply=this.specialAttackObj.launchAngle[t],tKnockback=calculateKnockback(this.otherPlayer.percentage,this.specialAttackObj.damage[t],this.otherPlayer.weight,this.specialAttackObj.scaling,this.specialAttackObj.knockback),this.otherPlayer.isHit=!0,this.isPlayer1?player1Info.totalAttacksHit+=1:player2Info.totalAttacksHit+=1,this.otherPlayer.hitByB[t]=!0,this.doKnockBack(damageToDeal,angleToApply,tKnockback))},doKnockBack:function(t,i,s){var a,e,h=new THREE.Vector2;h.x=this.otherPlayer.x-this.x,h.y=this.otherPlayer.y-this.y,h=h.normalize(),a=Math.cos(radians(i))*h.x-Math.sin(radians(i))*h.y,e=Math.sin(radians(i))*h.x+Math.cos(radians(i))*h.y,h.x=a,h.y=Math.abs(e),h=h.normalize(),this.isPlayer1?player1Info.damageDealt+=t:player2Info.damageDealt+=t,this.otherPlayer.percentage+=t,this.otherPlayer.xVel=.5*s*h.x,this.otherPlayer.yVel=.5*s*h.y,this.otherPlayer.hitFrames=2*t,this.otherPlayer.xVel>0?this.otherPlayer.model.rotation.z=-1.57:this.otherPlayer.model.rotation.z=1.57}};function createZ(t,i,s,a){var e=new THREE.Mesh,h=new THREE.Mesh,c=particles.particlePalette.sleepPiece.clone();h.add(c),c.position.x+=2;var o=particles.particlePalette.sleepPiece.clone();h.add(o);var n=particles.particlePalette.sleepPiece.clone();h.add(n),n.position.x-=2;var l=particles.particlePalette.sleepPiece.clone();h.add(l),l.position.x-=1.2,l.position.y+=2;var r=particles.particlePalette.sleepPiece.clone();h.add(r),r.position.x+=1.2,r.position.y+=4;var A=particles.particlePalette.sleepPiece.clone();h.add(A),A.position.x+=2,A.position.y+=6;var k=particles.particlePalette.sleepPiece.clone();h.add(k),k.position.y+=6;var y=particles.particlePalette.sleepPiece.clone();return h.add(y),y.position.x-=2,y.position.y+=6,z2=h.clone(),z3=h.clone(),h.scale.set(.3,.3,.3),e.add(h),z2.scale.set(.45,.45,.45),e.add(z2),z2.position.set(-1.4,2.5,0),z3.scale.set(.55,.55,.55),e.add(z3),z3.position.set(1.8,7.2,0),t.scene.add(e),e.position.set(i,s,a),e}function createMusic(t,i,s,a){for(var e=[],h=0;h<27;h++){var c=particles.particlePalette.musicPiece.clone();e.push(c),t.scene.add(c)}return e}
