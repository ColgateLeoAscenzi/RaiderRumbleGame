var RESET=!1,ATTACK=!0,raider={name:"Name",model:createNameMesh(0,0,0),hitBox:createBasicCharacterBounding(0,0,0),canAAttack:[!0,!0,!0,!0,!0],canBAttack:[!0,!0,!0,!0],hitByA:[!1,!1,!1,!1,!1],hitByB:[!1,!1,!1,!1],init:function(){for(var t=Object.keys(charProto),i=0;i<t.length;i++)this[t[i]]=charProto[t[i]];this.name="Name",this.heldKeys={up:!1,down:!1,left:!1,right:!1,attack1:!1,attack2:!1},this.basicAttackObj=NameBasic,this.specialAttackObj=NameSpecial,this.damageDeal=0},setSpawn:function(){this.isPlayer1?(this.x=stage.player1SpawnX,this.y=stage.player1SpawnY,this.z=stage.player1SpawnZ):(this.x=stage.player2SpawnX,this.y=stage.player2SpawnY,this.z=stage.player2SpawnZ)},update:function(){stage.night&&(stage.player1SpotTarget.position.set(this.x,this.y+10,-10),stage.player1Spot.target=stage.player1SpotTarget),this.hitbbox=(new THREE.Box3).setFromObject(this.hitBox),null!=this.boxBelow?this.minDown=this.boxBelow.position.y+this.boxBelow.userData.height/2+this.height/2:this.minDown=-1e3,null!=this.boxLeft?this.minLeft=this.boxLeft.position.x+this.boxLeft.userData.width/2+this.width/2:this.minLeft=-1e3,null!=this.boxRight?this.minRight=this.boxRight.position.x-this.boxRight.userData.width/2-this.width/2:this.minRight=1e3,null!=this.boxAbove?this.minUp=this.boxAbove.position.y-this.boxAbove.userData.height/2-this.height/2:this.minUp=1e5,this.isHit&&(this.hitFrames-=1),this.hitFrames<0&&(this.isHit=!1),this.yVel-.075<-1.6&&(this.yVel=-1.6),this.yVel-=.075,this.x+=this.xVel,this.y+=this.yVel,this.heldKeys.up&&this.heldKeys.attack2&&this.canRecover&&!this.isRecover&&(this.recover(),this.canJump=!1),!this.heldKeys.right||this.heldKeys.left||this.isHit||this.heldKeys.attack1||this.heldKeys.attack2||this.walkRight(),!this.heldKeys.left||this.heldKeys.right||this.isHit||this.heldKeys.attack1||this.heldKeys.attack2||this.walkLeft(),this.movingR||this.movingL||!this.onGround||this.isHit||(this.xVel=.7*this.xVel),this.movingR||this.movingL||this.onGround||this.isHit||(this.xVel=.99*this.xVel),Math.abs(this.xVel)<5e-4&&(this.xVel=0),this.y<this.minDown&&(this.y=this.minDown,this.canJump=!0,this.jumpCt=0,this.onGround=!0,this.canRecover=!0,this.isRecover=!1),this.y>this.minUp&&(this.y=this.minUp,this.yVel=0),this.x<this.minLeft&&(this.x=this.minLeft),this.x>this.minRight&&(this.x=this.minRight),0==this.stock?(this.model.position.set(1e3,1e3,0),this.hitBox.position.set(1e3,1e3,0)):(this.model.position.set(this.x,this.y,0),this.hitBox.position.set(this.x,this.y+4,0)),this.y>this.minDown&&(this.onGround=!1)},animate:function(){this.facingR&&(this.model.rotation.y=.5),this.facingL&&(this.model.rotation.y=-.5),!this.movingR&&!this.movingL||0==this.xVel||this.isHit?(this.model.torso.rightLeg.position.y=-3,this.model.torso.leftLeg.position.y=-3,this.model.torso.rightLeg.rotation.x=0,this.model.torso.leftLeg.rotation.x=0,this.model.torso.rightArm.rotation.x=0,this.model.torso.leftArm.rotation.x=-0,this.canAAttack[A]&&!this.isHit&&(this.model.rotation.z=0)):(this.walkStyle1?(this.model.torso.rightLeg.position.y=.5*Math.sin(.5*stage.timer)-3,this.model.torso.leftLeg.position.y=-3-.5*Math.sin(.5*stage.timer)):this.walkStyle2?(this.model.torso.rightLeg.rotation.x=.3*Math.sin(.5*stage.timer),this.model.torso.leftLeg.rotation.x=-.3*Math.sin(.5*stage.timer)):this.walkStyle3&&(this.model.torso.rightLeg.position.y=.5*Math.sin(.2*stage.timer)-3,this.model.torso.leftLeg.position.y=-3-.5*Math.sin(.2*stage.timer),this.model.rotation.z=.1*Math.sin(.2*stage.timer)),this.model.torso.rightArm.rotation.x=.3*Math.sin(.5*stage.timer),this.model.torso.leftArm.rotation.x=-.3*Math.sin(.5*stage.timer),this.canAAttack[A]&&(this.model.rotation.z=0)),stage.timer%500==0?(this.model.head.rightEye.scale.set(1,.2,1),this.model.head.leftEye.scale.set(1,.2,1)):(this.model.head.rightEye.scale.set(1,1,1),this.model.head.leftEye.scale.set(1,1,1)),this.canAAttack[A]||(this.basicAttackFrames-=1,this.basicAttackFrames<=0&&(this.basicAttackFrames=25,this.canAAttack[BA]=!0,this.canBasicAttack=!0,this.otherPlayer.hitByA[BA]=!1)),this.canAAttack[FA]||(this.basicAttackFrames-=1,this.basicAttackFrames<=0&&(this.basicAttackFrames=25,this.canAAttack[BA]=!0,this.canBasicAttack=!0,this.otherPlayer.hitByA[BA]=!1)),this.canAAttack[BA]||(this.basicAttackFrames-=1,this.basicAttackFrames<=0&&(this.basicAttackFrames=25,this.canAAttack[BA]=!0,this.canBasicAttack=!0,this.otherPlayer.hitByA[BA]=!1)),this.canAAttack[DA]||(this.basicAttackFrames-=1,this.basicAttackFrames<=0&&(this.basicAttackFrames=25,this.canAAttack[DA]=!0,this.canBasicAttack=!0,this.otherPlayer.hitByA[DA]=!1)),this.canAAttack[UA]||(this.basicAttackFrames-=1,this.basicAttackFrames<=0&&(this.basicAttackFrames=25,this.canAAttack[UA]=!0,this.canBasicAttack=!0,this.otherPlayer.hitByA[UA]=!1)),this.canAAttack[NA]||(this.basicAttackFrames-=1,this.basicAttackFrames<=0&&(this.basicAttackFrames=25,this.canAAttack[NA]=!0,this.canBasicAttack=!0,this.otherPlayer.hitByA[NA]=!1)),this.canBAttack[S]||(this.basicAttackFrames-=1,this.basicAttackFrames<=0&&(this.basicAttackFrames=25,this.canBAttack[S]=!0,this.canBasicAttack=!0,this.otherPlayer.hitByB[S]=!1)),this.canBAttack[SS]||(this.basicAttackFrames-=1,this.basicAttackFrames<=0&&(this.basicAttackFrames=25,this.canBAttack[S]=!0,this.canBasicAttack=!0,this.otherPlayer.hitByB[S]=!1)),this.canBAttack[US]||(this.basicAttackFrames-=1,this.basicAttackFrames<=0&&(this.basicAttackFrames=25,this.canBAttack[US]=!0,this.canBasicAttack=!0,this.otherPlayer.hitByB[US]=!1)),this.canBAttack[DS]||(this.basicAttackFrames-=1,this.basicAttackFrames<=0&&(this.basicAttackFrames=25,this.canBAttack[DS]=!0,this.canBasicAttack=!0,this.otherPlayer.hitByB[DS]=!1))},walkRight:function(){this.movingR=!0,this.facingR=!0,this.facingL=!1,this.xVel+=this.xAccel,this.xVel>this.maxXVel&&(this.xVel=this.maxXVel),this.isHit=!1},walkLeft:function(){this.movingL=!0,this.facingL=!0,this.facingR=!1,this.xVel-=this.xAccel,this.xVel<-this.maxXVel&&(this.xVel=-this.maxXVel),this.isHit=!1},jump:function(){this.jumpCt==this.maxJumpCt&&(this.canJump=!1),this.canJump&&(this.isHit||(this.jumpCt+=1,this.yVel=this.jumpSpeed,this.onGround=!1,this.isHit=!1))},drop:function(){},recover:function(){this.isRecover=!0,this.yVel=this.recoverVel,this.canRecover=!1,this.isHit=!1},doAnyAttack:function(){if(this.canBasicAttack&&!this.isHit&&!this.isRecover){var t=0;this.heldKeys.up&&this.heldKeys.attack2&&this.canRecover&&!this.isRecover&&(this.recover(),this.canJump=!1),this.facingR&&this.heldKeys.right&&this.heldKeys.attack1&&!this.onGround&&this.canBasicAttack&&this.canAAttack[FA]&&(t=this.basicAttackObj.attackFrames[FA],this.canAAttack[FA]=!1,this.canBasicAttack=!1),this.facingL&&this.heldKeys.left&&this.heldKeys.attack1&&!this.onGround&&this.canBasicAttack&&1==this.canAAttack[FA]&&(t=this.basicAttackObj.attackFrames[FA],this.canAAttack[FA]=!1,this.canBasicAttack=!1),this.facingL&&this.heldKeys.right&&this.heldKeys.attack1&&!this.onGround&&this.canBasicAttack&&1==this.canAAttack[BA]&&(t=this.basicAttackObj.attackFrames[BA],this.canAAttack[BA]=!1,this.canBasicAttack=!1),this.facingR&&this.heldKeys.left&&this.heldKeys.attack1&&!this.onGround&&this.canBasicAttack&&1==this.canAAttack[BA]&&(t=this.basicAttackObj.attackFrames[BA],this.canAAttack[BA]=!1,this.canBasicAttack=!1),this.heldKeys.down&&this.heldKeys.attack1&&!this.onGround&&this.canBasicAttack&&1==this.canAAttack[DA]&&(t=this.basicAttackObj.attackFrames[DA],this.canAAttack[DA]=!1,this.canBasicAttack=!1),this.heldKeys.up&&this.heldKeys.attack1&&!this.onGround&&this.canBasicAttack&&1==this.canAAttack[UA]&&(t=this.basicAttackObj.attackFrames[UA],this.canAAttack[UA]=!1,this.canBasicAttack=!1),this.heldKeys.left||this.heldKeys.right||this.heldKeys.up||this.heldKeys.down||!this.heldKeys.attack1||this.onGround||!this.canBasicAttack||1==this.canAAttack[NA]&&(t=this.basicAttackObj.attackFrames[NA],this.canAAttack[NA]=!1,this.canBasicAttack=!1),this.heldKeys.attack1&&this.onGround&&this.canBasicAttack&&1==this.canAAttack[A]&&(t=this.basicAttackObj.attackFrames[A],this.canAAttack[A]=!1,this.canBasicAttack=!1),(this.heldKeys.right||this.heldKeys.left)&&this.heldKeys.attack2&&this.canBasicAttack&&1==this.canBAttack[SS]&&(t=this.specialAttackObj.attackFrames[SS],this.canBAttack[SS]=!1,this.canBasicAttack=!1),this.heldKeys.down||this.heldKeys.up||this.heldKeys.left||this.heldKeys.right||!this.heldKeys.attack2||!this.canBasicAttack||1==this.canBAttack[S]&&(t=this.specialAttackObj.attackFrames[S],this.canBAttack[S]=!1,this.canBasicAttack=!1),this.heldKeys.down&&this.heldKeys.attack2&&this.canBasicAttack&&1==this.canBAttack[DS]&&(t=this.specialAttackObj.attackFrames[DS],this.canBAttack[DS]=!1,this.canBasicAttack=!1),this.heldKeys.up&&this.heldKeys.attack2&&this.canBasicAttack&&1==this.canBAttack[US]&&(t=this.specialAttackObj.attackFrames[US],this.canBAttack[US]=!1,this.canBasicAttack=!1),this.basicAttackFrames=t}},checkHit:function(t,i){"A"==i?this.otherPlayer.hitByA[t]||(damageToDeal=this.basicAttackObj.damage[t],angleToApply=this.basicAttackObj.launchAngle[t],tKnockback=calculateKnockback(this.otherPlayer.percentage,this.basicAttackObj.damage[t],this.otherPlayer.weight,this.basicAttackObj.scaling,this.basicAttackObj.knockback),this.otherPlayer.isHit=!0,this.otherPlayer.hitByA[t]=!0,this.doKnockBack(damageToDeal,angleToApply,tKnockback)):this.otherPlayer.hitByB[t]||(damageToDeal=this.specialAttackObj.damage[t],angleToApply=this.specialAttackObj.launchAngle[t],tKnockback=calculateKnockback(this.otherPlayer.percentage,this.specialAttackObj.damage[t],this.otherPlayer.weight,this.specialAttackObj.scaling,this.specialAttackObj.knockback),this.otherPlayer.isHit=!0,this.otherPlayer.hitByB[t]=!0,this.doKnockBack(damageToDeal,angleToApply,tKnockback))},doKnockBack:function(t,i,s){var a,h,e=new THREE.Vector2;e.x=this.otherPlayer.x-this.x,e.y=this.otherPlayer.y-this.y,e=e.normalize(),a=Math.cos(radians(i))*e.x-Math.sin(radians(i))*e.y,h=Math.sin(radians(i))*e.x+Math.cos(radians(i))*e.y,e.x=a,e.y=Math.abs(h),e=e.normalize(),this.otherPlayer.percentage+=t,this.otherPlayer.xVel=.5*s*e.x,this.otherPlayer.yVel=.5*s*e.y,this.otherPlayer.hitFrames=2*t,this.otherPlayer.xVel>0?this.otherPlayer.model.rotation.z=-1.57:this.otherPlayer.model.rotation.z=1.57}};
