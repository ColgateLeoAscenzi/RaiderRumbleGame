function handleKeyUp(e){inGame&&("a"==e.key&&(stage.player1.heldKeys.left=!1,stage.player1.movingL=!1),"d"==e.key&&(stage.player1.heldKeys.right=!1,stage.player1.movingR=!1),"w"==e.key&&(stage.player1.heldKeys.up=!1,stage.player1.jumping=!1),"s"==e.key&&(stage.player1.heldKeys.down=!1),"j"==e.key&&(stage.player1.heldKeys.attack1=!1),"k"==e.key&&(stage.player1.heldKeys.attack2=!1),"ArrowLeft"==e.key&&(stage.player2.heldKeys.left=!1,stage.player2.movingL=!1),"ArrowRight"==e.key&&(stage.player2.heldKeys.right=!1,stage.player2.movingR=!1),"ArrowUp"==e.key&&(stage.player2.heldKeys.up=!1),"ArrowDown"==e.key&&(stage.player2.heldKeys.down=!1,stage.player2.jumping=!1),"1"==e.key&&(stage.player2.heldKeys.attack1=!1),"2"==e.key&&(stage.player2.heldKeys.attack2=!1)),inCharSelect&&("a"==e.key&&(heldDown1.left=!1),"d"==e.key&&(heldDown1.right=!1),"s"==e.key&&(heldDown1.down=!1),"w"==e.key&&(heldDown1.up=!1),"ArrowLeft"==e.key&&(heldDown2.left=!1),"ArrowRight"==e.key&&(heldDown2.right=!1),"ArrowDown"==e.key&&(heldDown2.down=!1),"ArrowUp"==e.key&&(heldDown2.up=!1))}function handleKeyDown(e){if(inGame){if("h"==e.key&&(drawRays=!drawRays,hitBoxesOn?(hitBoxesOn=!1,console.log("hitboxes off"),toggleHitBoxes(stage.stageHitBoxes,!1)):(hitBoxesOn=!0,console.log("hitboxes on"),toggleHitBoxes(stage.stageHitBoxes,!0))),"."==e.key){if(statsOn){var t=document.getElementById("stats");t.parentNode.removeChild(t),stats.end()}else stats=new Stats,stats.domElement.style.position="absolute",stats.domElement.style.bottom="0px",stats.domElement.style.zIndex=100,stats.domElement.id="stats",container.appendChild(stats.domElement),stats.begin();statsOn=!statsOn}"p"==e.key&&(trackPlayer?trackPlayer=!1:trackPlayer=!0),"m"==e.key&&(console.log("Playing "+stage.bgm),playingM?playingM&&(mediaElement.pause(),playingM=!1):(mediaElement.play(),playingM=!0)),stage.player1.canMove&&("a"==e.key&&(stage.player1.heldKeys.left=!0),"d"==e.key&&(stage.player1.heldKeys.right=!0),"w"==e.key&&(stage.player1.heldKeys.up=!0,stage.player1.jump(),this.isGrabLedge=!1,this.grabLedgeTimer=100),"s"==e.key&&(stage.player1.heldKeys.down=!0),"j"==e.key&&(stage.player1.heldKeys.attack1=!0,stage.player1.doAnyAttack()),"k"==e.key&&(stage.player1.heldKeys.attack2=!0,stage.player1.doAnyAttack())),stage.player2.canMove&&("ArrowLeft"==e.key&&(stage.player2.heldKeys.left=!0),"ArrowRight"==e.key&&(stage.player2.heldKeys.right=!0),"ArrowUp"==e.key&&(stage.player2.heldKeys.up=!0,stage.player2.jump()),"ArrowDown"==e.key&&(stage.player2.heldKeys.down=!0),"1"==e.key&&(stage.player2.heldKeys.attack1=!0,stage.player2.doAnyAttack()),"2"==e.key&&(stage.player2.heldKeys.attack2=!0,stage.player2.doAnyAttack()))}if(inStageSelect&&("ArrowUp"==e.key&&(isDay=!0,removeLights(mapScene),stageSelectLightsDay(mapScene)),"ArrowDown"==e.key&&(isDay=!1,removeLights(mapScene),stageSelectLightsNight(mapScene)),"ArrowLeft"==e.key&&(omegaOn=!0),"ArrowRight"==e.key&&(omegaOn=!1)),inPostGame&&(" "!=e.key&&"Enter"!=e.key||playAgain()),inMainMenu&&"Alt"!=e.key&&"Shift"!=e.key&&"Tab"!=e.key&&"l"!=e.key)if("."==e.key||devMode){if(!devMode){params=new devParameters;const e=new dat.GUI({autoPlace:!0});e.domElement.id="gui",folder=e.addFolder("Quick Select"),folder.add(params,"selectedPlayer1"),folder.add(params,"selectedPlayer2"),folder.add(params,"isDay"),folder.add(params,"omegaOn"),folder.add(params,"stage"),folder.add(params,"submit"),devMode=!0}}else titleClicked=!0;inCharSelect&&("a"==e.key&&(heldDown1.left=!0),"d"==e.key&&(heldDown1.right=!0),"s"==e.key&&(heldDown1.down=!0),"w"==e.key&&(heldDown1.up=!0),"j"==e.key&&(p1SelectorMesh.userData.grabbing?dropPlayer(p1SelectorMesh,p1Model):checkCollision(p1SelectorMesh,charSelectHitboxes)),"ArrowLeft"==e.key&&(heldDown2.left=!0),"ArrowRight"==e.key&&(heldDown2.right=!0),"ArrowDown"==e.key&&(heldDown2.down=!0),"ArrowUp"==e.key&&(heldDown2.up=!0),"1"==e.key&&(p2SelectorMesh.userData.grabbing?dropPlayer(p2SelectorMesh,p2Model):checkCollision(p2SelectorMesh,charSelectHitboxes))," "==e.key&&null!=selectedPlayer1&&null!=selectedPlayer2&&p1InPosition&&p2InPosition&&(charactersSelected=!0))}function toggleHitBoxes(e,t){if(t)for(var a=0;a<e.length;a++)stage.scene.add(e[a]);else for(a=0;a<e.length;a++)stage.scene.remove(e[a]);stage.player1.addedHitBox=!0,stage.player2.addedHitBox=!0,stage.player1.hitBoxEnabled=!0,stage.player2.hitBoxEnabled=!0}function onMouseMove(e){mouse.x=e.clientX/window.innerWidth*2-1,mouse.y=-e.clientY/window.innerHeight*2+1}function onMouseDown(e){inStageSelect&&HIGHLITED&&(selectedStage=HIGHLITED.userData,stageSelected=!0),inModeSelect&&SELECTEDMODE&&"playGame"==SELECTEDMODE.userData.mode&&(modeSelected=!0),inMainMenu&&selectingTitle&&(selectingTitle=!1,titleClicked=!0)}
