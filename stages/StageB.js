var stageB={init:function(){for(var e=Object.keys(stageProto),t=0;t<e.length;t++)this[e[t]]=charProto[e[t]];this.bgm="./sounds/My happy song Nicholas w lott.mp3",this.skyBoxURL="./images/foggyBottom.png",this.omega=omegaOn,this.blockA=grassBox,this.blockB=dirtBlockB,this.blockC=cloudIco,this.snowing=!1,this.stageBlocks=[],this.blockAMeshes=[],this.stageHitBoxes=[],this.players=[],this.timer=0,this.timerIncrement=0,this.maxTim=180,this.minimumY=-80,this.maximumY=280,this.minimumX=-300,this.maximumX=300,this.player1SpawnX=-10,this.player1SpawnY=10,this.player1SpawnZ=0,this.player2SpawnX=10,this.player2SpawnY=10,this.player2SpawnZ=0,this.createScene(),omegaOn?this.populateOmega():this.populateScene(),this.player1=selectedPlayer1,this.player1.init(),this.player1.isPlayer1=!0,this.player1.setSpawn(),this.player2=selectedPlayer2,this.player2.init(),this.player2.setSpawn(),this.player2.isPlayer1=!1,createPlayer1(this.player1SpawnX,this.player1SpawnY,this.player1SpawnZ,this),createPlayer2(this.player2SpawnX,this.player2SpawnX,this.player2SpawnZ,this),this.player1.otherPlayer=this.player2,this.player2.otherPlayer=this.player1,this.player1.hitbbox=(new THREE.Box3).setFromObject(this.player1.hitBox),this.player2.hitbbox=(new THREE.Box3).setFromObject(this.player2.hitBox),this.createSpotLights(),this.startTimer()},createScene:function(){this.scene=new THREE.Scene,isDay?(sunsetLights(this.scene,this.skyBoxURL),$(document.getElementById("theBody")).css("color","black")):(nightLights(this.scene),$(document.getElementById("theBody")).css("color","white"))},populateScene:function(){for(var e=-10;e<11;e++)-8!=e&&8!=e||(createBox(e*this.blockA.width,this.blockA.height,0,this.blockA,stageB),createBox(e*this.blockA.width,2*this.blockA.height,0,this.blockA,stageB)),-4!=e&&-3!=e&&-2!=e&&2!=e&&3!=e&&4!=e||createBox(e*this.blockC.width,7*this.blockC.height,-12,this.blockC,stageB),createBox(e*this.blockA.width,0,0,this.blockA,stageB)},populateOmega:function(){for(var e=-10;e<11;e++)-10==e||10==e?createBox(e*this.blockC.width,this.blockA.height/4,-12,this.blockC,stageB):createBox(e*this.blockA.width,0,0,this.blockA,stageB);for(var t=1;t<5;t++)for(e=-10+t;e<11-t;e++){Math.random();createBox(e*this.blockA.width,-t*this.blockB.height,0,this.blockB,stageB)}for(e=-10+t;e<11-t;e++)-4!=e&&-3!=e&&-2!=e&&2!=e&&3!=e&&4!=e||(createBox(e*this.blockA.width,4*this.blockA.height,0,this.blockC,stageB),createBox(e*this.blockA.width,7*this.blockA.height,-12,this.blockC,stageB))},update:function(){if(countDown&&(document.getElementById("timerBox").innerHTML="Time: "+(this.maxTime-Math.floor(this.timer/60)),this.timer+=this.timerIncrement,this.maxTime-Math.floor(this.timer/60)==0&&(document.getElementById("timerBox").innerHTML="GO!",this.player1.canMove=!0,this.player2.canMove=!0,this.maxTime=180,this.timer=0,gameStarted=!0,countDown=!1)),!roundOver&&gameStarted){this.timer+=this.timerIncrement,document.getElementById("timerBox").innerHTML="Time: "+(this.maxTime-Math.floor(this.timer/60));for(var e=0;e<this.stageBlocks.length;e++)this.stageBlocks[e].update();this.maxTime-Math.floor(this.timer/60)==0&&(roundOver=!0,roundOver=!0)}for(let e=0;e<stage.players.length;e++)(stage.players[e].y>=stage.maximumY||stage.players[e].y<=stage.minimumY||stage.players[e].x>=stage.maximumX||stage.players[e].x<=stage.minimumX)&&(stage.players[e].y=10,stage.players[e].x=0,stage.players[e].xVel=0,stage.players[e].yVel=0,stage.players[e].stock-=1,stage.players[e].percentage=0);var t="";for(e=0;e<this.player1.stock;e++)t+="<i class='fas fa-heart' style='color:violet'></i> ";var i="";for(e=0;e<this.player2.stock;e++)i+="<i class='fas fa-heart' style='color:violet'></i> ";for(e=0;e<this.players.length;e++)this.players[e].percentage<40?isDay?color="black:":color="white":this.players[e].percentage<60?color="yellow":this.players[e].percentage<80?color="orange":color="red",0==e?player1Box.innerHTML="<div id = 'player1Name'>"+this.player1.name+"</div><div id = 'player1Stock'"+t+"</div><div id ='player1Percent' style = 'color: "+color+";'>"+this.player1.percentage+"%</div>":player2Box.innerHTML="<div id = 'player2Name'>"+this.player2.name+"</div><div id = 'player2Stock'"+i+"</div><div id ='player2Percent' style = 'color: "+color+";'>"+this.player2.percentage+"%</div>";0!=this.player1.stock&&0!=this.player2.stock||(roundOver=!0,roundOver=!0),roundOver&&(this.player1.canMove=!1,this.player2.canMove=!1,this.player1.stock>this.player2.stock?(document.getElementById("timerBox").innerHTML="GAME!<br>Player 1 Wins!",winner=1):this.player2.stock>this.player1.stock?(document.getElementById("timerBox").innerHTML="GAME!<br>Player 2 Wins!",winner=2):document.getElementById("timerBox").innerHTML="GAME!<br>It's a tie!")},startTimer:function(){this.timerIncrement=1,this.timer=0;var e=document.getElementById("container"),t=document.createElement("div");t.id="timerBox",t.innerHTML="Time: "+(this.maxTime-Math.floor(this.timer/60)),e.appendChild(t),countDown=!0,this.maxTime=3;var i=document.createElement("div");i.id="player1Box",i.innerHTML="<div id='player1Stock'>Stock: "+this.player1.stock+"</div><div id='player1Percent'>Percent: "+this.player1.percentage+"</div>",e.appendChild(i);var s=document.createElement("div");s.id="player2Box",s.innerHTML="<div id ='player2Stock'> Stock: "+this.player2.stock+"</div><div id ='player2Percent'>Percent: "+this.player2.percentage+"</div>",e.appendChild(s)},createSpotLights:function(){this.night&&createFollowSpotlights()}};
